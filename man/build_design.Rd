% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/class_design.R
\name{build_design}
\alias{build_design}
\title{Build a Design for Power Analysis}
\usage{
build_design(
  model_name = NULL,
  sim_fn = NULL,
  inference_model = NULL,
  backend = c("brms", "bf"),
  backend_args_brms = list(),
  backend_args_bf = list(batch_size = NULL, n_posterior_samples = 1000L, envname = NULL),
  n_endpoints = NULL,
  endpoint_types = NULL,
  n_arms = NULL,
  n_repeated_measures = NULL,
  target_params,
  design_name = NULL
)
}
\arguments{
\item{model_name}{Character. Name of a predefined model. Use \code{\link[=show_predefined_models]{show_predefined_models()}}
to see available options. If provided, model components are loaded automatically.
Takes precedence over explicit component arguments.}

\item{sim_fn}{A function that simulates trial data. Must accept parameters
\code{n_total} and \code{p_alloc} at minimum. Required if \code{model_name} is NULL.}

\item{inference_model}{A brmsfit object (for brms backend) or BayesFlow model
(for bf backend). Required if \code{model_name} is NULL.}

\item{backend}{Which backend to use: "brms" (default) or "bf".
\itemize{
\item "brms": Load brms model (default, always available)
\item "bf": Try BayesFlow, fall back to brms with warning if unavailable
}}

\item{backend_args_brms}{List of brms-specific arguments (chains, iter, etc.)}

\item{backend_args_bf}{List of BayesFlow-specific arguments:
\describe{
\item{batch_size}{Batch size for inference (default: NULL, uses n_sims)}
\item{n_posterior_samples}{Number of posterior samples (default: 1000)}
\item{envname}{Python virtual environment name to use (default: NULL for auto-detect)}
}}

\item{n_endpoints}{Number of endpoints (positive integer). Required if \code{model_name} is NULL.}

\item{endpoint_types}{Character vector of endpoint types ("continuous", "binary", "count").
Required if \code{model_name} is NULL.}

\item{n_arms}{Number of arms including control (positive integer). Required if \code{model_name} is NULL.}

\item{n_repeated_measures}{Number of repeated measures (NULL or 0 for single timepoint)}

\item{target_params}{Character vector specifying which model parameters to
analyze for power. Must be valid parameter names from the inference model.
Use \code{design@par_names_inference} to discover available names. Required.}

\item{design_name}{Optional character string providing a descriptive name.}
}
\value{
An S7 object of class "rctbp_design"
}
\description{
Creates an S7 rctbp_design object that encapsulates all components needed for
Bayesian power analysis: simulation function, inference model, trial metadata,
and analysis configuration.
}
\details{
This function creates a design object that contains the model specification
(simulation function, inference model) and target parameters. Decision
thresholds (\code{p_sig_scs}, \code{p_sig_ftl}, \code{thresh_scs}, \code{thresh_ftl}) and
sequential analysis settings (\code{analysis_at}) are specified in \code{\link[=build_conditions]{build_conditions()}}.

\strong{Predefined Models:} For most users, specify \code{model_name} to use a
predefined model configuration. Available models can be listed with
\code{\link[=show_predefined_models]{show_predefined_models()}}.

\strong{Custom Models:} For custom analyses, provide explicit \code{sim_fn} and
\code{inference_model} arguments along with trial metadata.
}
\examples{
\dontrun{
# Using a predefined model (recommended)
design <- build_design(
  model_name = "ancova_cont_2arms",
  target_params = "b_arm2"
)

# Check available parameter names
design@par_names_inference
design@par_names_sim

# Custom model (advanced)
design <- build_design(
  sim_fn = my_sim_function,
  inference_model = my_brmsfit,
  backend = "brms",
  n_endpoints = 1,
  endpoint_types = "continuous",
  n_arms = 2,
  target_params = "b_treatment"
)
}
}
\seealso{
\code{\link[=build_conditions]{build_conditions()}}, \code{\link[=show_predefined_models]{show_predefined_models()}}, \code{\link[=power_analysis]{power_analysis()}}
}
