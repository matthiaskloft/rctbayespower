% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analytical_power.R
\name{analytical_power_ancova_cont_2arms}
\alias{analytical_power_ancova_cont_2arms}
\title{Power Calculation for ANCOVA with Continuous Covariate and Two Groups}
\usage{
analytical_power_ancova_cont_2arms(
  n,
  d,
  beta_cov,
  sigma,
  equal_groups = TRUE,
  p_group = 0.5,
  alpha = 0.05,
  alternative = c("two.sided", "greater", "less"),
  method = c("cohen", "theory"),
  covariate_method = c("fixed", "expected"),
  numint = 2000
)
}
\arguments{
\item{n}{Integer or vector of integers. Total sample size(s) across both groups.}

\item{d}{Numeric or vector of numerics. Cohen's d for the group effect (standardized mean difference).
This represents the difference in group means divided by the pooled standard
deviation, after adjusting for the covariate. For two-sided tests, the sign
doesn't matter. For one-sided tests, positive d means group 1 > group 0.}

\item{beta_cov}{Numeric. True regression coefficient for the continuous covariate.
Assumes the covariate follows a standard normal distribution N(0,1).}

\item{sigma}{Numeric. Residual standard deviation of the outcome after fitting
the full model (including both covariate and group effects).}

\item{equal_groups}{Logical. If TRUE (default), assumes equal group sizes (n1 = n2).
If FALSE, requires p_group to be specified.}

\item{p_group}{Numeric. Proportion in group 1 (only used if equal_groups = FALSE).}

\item{alpha}{Numeric. Type I error rate (significance level). Default is 0.05.}

\item{alternative}{Character. Specifies the alternative hypothesis. Must be one of
"two.sided" (default), "greater", or "less". For one-sided tests, "greater"
tests if group 1 > group 0, "less" tests if group 1 < group 0.}

\item{method}{Character. Specifies the lambda calculation method. Must be one of:
\itemize{
\item "cohen" (default): Uses Cohen's convention where \eqn{\lambda = f^{2}(u + v + 1)}
\item "theory": Uses statistical theory where \eqn{\lambda = n \cdot f^{2}}
}}

\item{covariate_method}{Character. Specifies how to handle the covariate. Must be one of:
\itemize{
\item "fixed" (default): Assumes fixed covariate values (conditional power)
\item "expected": Integrates over covariate distribution (expected power, SAS-style)
}}

\item{numint}{Integer. Number of integration points for covariate_method = "expected" (default = 2000).}
}
\value{
Numeric vector. The statistical power(s) to detect the specified group effect(s).
If both n and d are vectors, returns a vector with length equal to the maximum of their lengths.
}
\description{
Computes the analytical power to detect a group effect in an Analysis of Covariance
(ANCOVA) model with one continuous covariate and two groups. The model takes the form:
\code{y ~ covariate + group}, where the covariate is assumed to follow N(0,1).
This function is vectorized and can handle multiple values for n and/or d parameters.
}
\details{
The function calculates power for testing the group effect in a linear model:
\itemize{
\item The outcome y is modeled as: \eqn{y = \beta_0 + \beta_1 \cdot \text{covariate} + \beta_2 \cdot \text{group} + \epsilon}
\item The null hypothesis is \eqn{H_0: \beta_2 = 0}
\item For two-sided tests: \eqn{H_1: \beta_2 \neq 0}
\item For one-sided tests: \eqn{H_1: \beta_2 > 0} (if alternative = "greater") or \eqn{H_1: \beta_2 < 0} (if alternative = "less")
\item The covariate follows \eqn{N(0,1)}
\item Group is coded as 0 or 1
\item Residuals \eqn{\epsilon} follow \eqn{N(0, \sigma^{2})}
}

Method options:
\itemize{
\item "cohen": Uses Cohen's convention matching pwr.f2.test
\item "theory": Uses classical statistical theory
}

Covariate method options:
\itemize{
\item "fixed": Conditional power given fixed covariate values
\item "expected": Expected power integrating over covariate distribution (SAS approach)
}

For two-sided tests, the function uses the F-test which is equivalent to the
square of a two-sided t-test. For one-sided tests, it uses the t-distribution
directly.
}
\note{
This function assumes:
\itemize{
\item No interaction between group and covariate
\item The covariate has the same variance in both groups
\item The residual variance is homogeneous across groups
}
}
\examples{
\donttest{
# Two-sided test with Cohen's method and fixed covariate
analytical_power_ancova_cont_2arms(n = 100, d = 0.5, beta_cov = 0.4, sigma = 1)

# Using statistical theory method
analytical_power_ancova_cont_2arms(n = 100, d = 0.5, beta_cov = 0.4, sigma = 1,
                                   method = "theory")

# Using expected power with Cohen's lambda
analytical_power_ancova_cont_2arms(n = 100, d = 0.5, beta_cov = 0.4, sigma = 1,
                                   covariate_method = "expected")

# Using expected power with theory lambda
analytical_power_ancova_cont_2arms(n = 100, d = 0.5, beta_cov = 0.4, sigma = 1,
                                   method = "theory", covariate_method = "expected")

# Vectorized: multiple sample sizes
analytical_power_ancova_cont_2arms(n = c(50, 100, 150), d = 0.5, beta_cov = 0.4, sigma = 1)

# One-sided test (group 1 > group 0)
analytical_power_ancova_cont_2arms(n = 100, d = 0.5, beta_cov = 0.4, sigma = 1,
                                   alternative = "greater")

# Unequal groups (70/30 split)
analytical_power_ancova_cont_2arms(n = 150, d = 0.5, beta_cov = 0.4, sigma = 1,
                                   equal_groups = FALSE, p_group = 0.7)
}

}
\references{
Cohen, J. (1988). Statistical Power Analysis for the Behavioral Sciences (2nd ed.).
Lawrence Erlbaum Associates.

Shieh, G. (2020). Power analysis and sample size planning in ANCOVA designs.
Psychometrika, 85(1), 101-120.
}
