% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analytical_power.R
\name{analytical_power_ancova_cont_2arms}
\alias{analytical_power_ancova_cont_2arms}
\title{Power Calculation for ANCOVA with Continuous Covariate and Two Groups}
\usage{
analytical_power_ancova_cont_2arms(
  n,
  d,
  beta_cov,
  sigma,
  p_alloc = c(0.5, 0.5),
  alpha = 0.05,
  alternative = c("two.sided", "greater", "less")
)
}
\arguments{
\item{n}{Integer or vector of integers. Total sample size(s) across both groups.}

\item{d}{Numeric or vector of numerics. Cohen's d for the group effect (standardized mean difference).
This represents the difference in group means divided by the pooled standard
deviation, after adjusting for the covariate. For two-sided tests, the sign
doesn't matter. For one-sided tests, positive d means group 1 > group 0.}

\item{beta_cov}{Numeric. True regression coefficient for the continuous covariate.
Assumes the covariate follows a standard normal distribution N(0,1).}

\item{sigma}{Numeric. Residual standard deviation of the outcome after fitting
the full model (including both covariate and group effects).}

\item{p_alloc}{Numeric vector of length 2. Allocation proportions for the two groups.
Must sum to 1. Default is \code{c(0.5, 0.5)} for equal allocation.}

\item{alpha}{Numeric. Type I error rate (significance level). Default is 0.05.}

\item{alternative}{Character. Specifies the alternative hypothesis. Must be one of
"two.sided" (default), "greater", or "less". For one-sided tests, "greater"
tests if group 1 > group 0, "less" tests if group 1 < group 0.}
}
\value{
Numeric vector. The statistical power(s) to detect the specified group effect(s).
If both n and d are vectors, returns a vector with length equal to the maximum of their lengths.
}
\description{
Computes the analytical power to detect a group effect in an Analysis of Covariance
(ANCOVA) model with one continuous covariate and two groups. The model takes the form:
\code{y ~ covariate + group}, where the covariate is assumed to follow N(0,1).
This function is vectorized and can handle multiple values for n and/or d parameters.
}
\details{
The function calculates power for testing the group effect in a linear model:
\itemize{
\item The outcome y is modeled as: y = β₀ + β₁·covariate + β₂·group + ε
\item The null hypothesis is H₀: β₂ = 0
\item For two-sided tests: H₁: β₂ ≠ 0
\item For one-sided tests: H₁: β₂ > 0 (if alternative = "greater") or β₂ < 0 (if alternative = "less")
\item The covariate follows N(0,1)
\item Group is coded as 0 or 1
\item Residuals ε follow N(0, σ²)
}

For two-sided tests, the function uses the F-test which is equivalent to the
square of a two-sided t-test. For one-sided tests, it uses the t-distribution
directly.
}
\note{
This function assumes:
\itemize{
\item No interaction between group and covariate
\item The covariate has the same variance in both groups
\item The residual variance is homogeneous across groups
}
}
\examples{
# Two-sided test with equal allocation
analytical_power_ancova_cont_2arms(n = 100, d = 0.5, beta_cov = 0.4, sigma = 1)

# Vectorized: multiple sample sizes with fixed effect size
analytical_power_ancova_cont_2arms(n = c(50, 100, 150), d = 0.5, beta_cov = 0.4, sigma = 1)

# Vectorized: multiple effect sizes with fixed sample size
analytical_power_ancova_cont_2arms(n = 100, d = c(0.2, 0.5, 0.8), beta_cov = 0.4, sigma = 1)

# Vectorized: both n and d (recycled to same length)
analytical_power_ancova_cont_2arms(n = c(80, 120), d = c(0.3, 0.7), beta_cov = 0.4, sigma = 1)

# One-sided test (group 1 > group 0)
analytical_power_ancova_cont_2arms(n = 100, d = 0.5, beta_cov = 0.4, sigma = 1,
                                   alternative = "greater")

# Unequal allocation (2:1 ratio)
analytical_power_ancova_cont_2arms(n = 150, d = 0.5, beta_cov = 0.4, sigma = 1,
                                   p_alloc = c(2/3, 1/3))

}
\references{
Cohen, J. (1988). Statistical Power Analysis for the Behavioral Sciences (2nd ed.).
Lawrence Erlbaum Associates.

Shieh, G. (2020). Power analysis and sample size planning in ANCOVA designs.
Psychometrika, 85(1), 101-120.
}
